<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero-Touch Merch Campaign Engine - Demo</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 1600px; 
            margin: 0 auto; 
            background: white; 
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(135deg, #0F1419, #232F3E);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 3em; margin-bottom: 15px; }
        .header p { font-size: 1.3em; opacity: 0.9; }
        .demo-badge {
            background: #e74c3c;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 15px;
            display: inline-block;
        }
        
        .nav-tabs {
            display: flex;
            background: #34495e;
            overflow-x: auto;
            justify-content: center;
        }
        .nav-tab {
            padding: 15px 25px;
            color: white;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .nav-tab:hover { background: rgba(255,255,255,0.1); }
        .nav-tab.active { 
            background: rgba(255,255,255,0.2); 
            border-bottom-color: #3498db;
        }
        .nav-tab.hve-tab {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            color: white;
        }
        .nav-tab.hve-tab:hover {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        .nav-tab.hve-tab.active {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            border-bottom-color: #e74c3c;
        }
        
        .tab-content { display: none; padding: 30px; }
        .tab-content.active { display: block; }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        .metric-number { font-size: 2.5em; font-weight: bold; margin-bottom: 10px; }
        .metric-label { font-size: 1.1em; opacity: 0.9; }
        
        .section {
            background: #f8f9fa;
            margin-bottom: 25px;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .demo-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #27ae60;
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        .feature-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .feature-desc {
            color: #7f8c8d;
            line-height: 1.6;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .data-table th, .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }
        .data-table th {
            background: linear-gradient(45deg, #34495e, #2c3e50);
            color: white;
            font-weight: 600;
        }
        .data-table tr:hover { background: #f8f9fa; }
        
        .recommendation-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .rec-dotd { background: #e74c3c; color: white; }
        .rec-bd { background: #f39c12; color: white; }
        .rec-ld { background: #9b59b6; color: white; }
        .rec-ped { background: #27ae60; color: white; }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }
        .alert-success { background: #d4edda; color: #155724; border-left: 4px solid #27ae60; }
        .alert-warning { background: #fff3cd; color: #856404; border-left: 4px solid #f39c12; }
        .alert-info { background: #d1ecf1; color: #0c5460; border-left: 4px solid #17a2b8; }
        
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid { grid-template-columns: 1fr; }
            .demo-features { grid-template-columns: 1fr; }
            .nav-tabs { flex-direction: column; }
            .header h1 { font-size: 2em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Zero-Touch Merch Campaign Engine</h1>
            <p>Intelligent Merchandising & Campaign Automation Platform</p>
            <div class="demo-badge">üéØ LIVE DEMO</div>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">üè† Overview</button>
            <button class="nav-tab hve-tab" onclick="showTab('hve-analysis')">üîç HVE Analysis</button>
            <button class="nav-tab" onclick="showTab('data-management')">üìÅ Target ASIN Sourcing Engine</button>
            <button class="nav-tab" onclick="showTab('dashboard')">üìä Target ASIN Performance Dashboard</button>
            <button class="nav-tab" onclick="showTab('performance')">üìà MCID/Brand Level Performance</button>
            <button class="nav-tab" onclick="showTab('email-automation')">üìß Email Automation</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="section">
                <h2>üéØ Project Overview</h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; margin: 30px 0;">
                    <!-- Goal 1 Card -->
                    <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(52, 152, 219, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: -20px; right: -20px; font-size: 100px; opacity: 0.1;">üìà</div>
                        <h3 style="font-size: 1.4em; margin-bottom: 15px; font-weight: bold;">üöÄ Goal 1: Enhance Promotion OPS</h3>
                        <p style="margin-bottom: 20px; line-height: 1.6; opacity: 0.95;">Optimize promotion performance sourcing, tracking and forecasting to maximize revenue impact across all promotion types.</p>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; border-left: 4px solid #f1c40f;">
                            <strong>üí∞ Impact:</strong><br>
                            Real-time OPS monitoring, improved target ASIN submission rates, enhanced inventory management and performance analytics.
                        </div>
                    </div>
                    
                    <!-- Goal 2 Card -->
                    <div style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(39, 174, 96, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: -20px; right: -20px; font-size: 100px; opacity: 0.1;">‚ö°</div>
                        <h3 style="font-size: 1.4em; margin-bottom: 15px; font-weight: bold;">‚ö° Goal 2: Improve AM Work Efficiency</h3>
                        <p style="margin-bottom: 20px; line-height: 1.6; opacity: 0.95;">AMs spend 1-2 hours in BAU and 3-4 hours in HVE daily manually processing promotion ASIN data to help sellers submit deals and analyze merchandising performance, affecting 50+ AMs globally with 200+ hours weekly.</p>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; border-left: 4px solid #f39c12;">
                            <strong>‚è±Ô∏è Impact:</strong><br>
                            80% time reduction (4 hours ‚Üí 30 mins daily), 200+ hours saved weekly, 80% faster seller report delivery.
                        </div>
                    </div>
                    
                    <!-- Goal 3 Card -->
                    <div style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(155, 89, 182, 0.3); position: relative; overflow: hidden;">
                        <div style="position: absolute; top: -20px; right: -20px; font-size: 100px; opacity: 0.1;">üîç</div>
                        <h3 style="font-size: 1.4em; margin-bottom: 15px; font-weight: bold;">üîç Goal 3: Deep HVE Analysis</h3>
                        <p style="margin-bottom: 20px; line-height: 1.6; opacity: 0.95;">Previously lacked deep analysis of HVE events at PG-GL-ASP-ASIN AGE level, missing comprehensive understanding of different marketplace HVE performance.</p>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; border-left: 4px solid #e74c3c;">
                            <strong>üåç Impact:</strong><br>
                            Enhanced global marketplace HVE analysis deep into PG-GL-ASIN AGE-ASP level, providing comprehensive global perspective for strategic decision making.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="demo-features">
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <div class="feature-title">AI-Powered Recommendations</div>
                    <div class="feature-desc">Intelligent promotion recommendations (DOTD/BD/LD/PED) based on custom metrics and historical performance data.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <div class="feature-title">Smart Analytics Dashboard</div>
                    <div class="feature-desc">Real-time performance tracking, campaign success metrics, and predictive insights for better decision making.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìß</div>
                    <div class="feature-title">Automated Email Campaigns</div>
                    <div class="feature-desc">Bulk email distribution with MCID mapping, custom templates, and automatic Excel attachment generation.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìÖ</div>
                    <div class="feature-title">Campaign Calendar</div>
                    <div class="feature-desc">Timeline management, deadline tracking, and smart reminders to prevent campaign conflicts and missed opportunities.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <div class="feature-title">Zero-Touch Automation</div>
                    <div class="feature-desc">End-to-end workflow automation from data processing to seller communication, eliminating manual intervention.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üéØ</div>
                    <div class="feature-title">Performance Optimization</div>
                    <div class="feature-desc">Historical analysis, A/B testing framework, and ROI optimization based on campaign performance data.</div>
                </div>
            </div>
        </div>

        <!-- Data Management Tab -->
        <div id="data-management" class="tab-content">
            <div class="section">
                <h2>üì§ Data Upload</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div id="dataFileUpload" style="border: 3px dashed #3498db; border-radius: 10px; padding: 30px; text-align: center; background: #f8f9ff; cursor: pointer;" onclick="document.getElementById('dataFile').click()">
                        <input type="file" id="dataFile" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileUpload('dataFile', 'Target ASIN Data')" />
                        <h3>üìÅ Upload Target ASIN Data</h3>
                        <p>Main ASIN dataset for analysis</p>
                        <small>Required: MCID, Brand, Marketplace, ASIN, Price, Review_Count, Rating</small>
                        <div id="dataFileStatus" style="margin-top: 10px; font-weight: bold;"></div>
                    </div>
                    <div id="dotdFileUpload" style="border: 3px dashed #e74c3c; border-radius: 10px; padding: 30px; text-align: center; background: #fdf2f2; cursor: pointer;" onclick="document.getElementById('dotdFile').click()">
                        <input type="file" id="dotdFile" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileUpload('dotdFile', 'DOTD ASIN List')" />
                        <h3>üî• Upload DOTD ASIN List</h3>
                        <p>ASINs eligible for DOTD promotion</p>
                        <small>Required: ASIN, Marketplace</small>
                        <div id="dotdFileStatus" style="margin-top: 10px; font-weight: bold;"></div>
                    </div>
                </div>
                <button id="processBtn" onclick="processData()" style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 15px 5px;">üöÄ Process Data & Generate AI Recommendations</button>
                <div id="processStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            </div>
            

            
            <div class="section">
                <h2>üìã ASIN Data with AI Recommendations</h2>
                <div style="margin-bottom: 20px;">
                    <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Filter by Marketplace</label>
                    <select id="asinMarketplaceSelect" onchange="filterAsinTable()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 300px;">
                        <option>Select Marketplace</option>
                        <option value="all">ÂÖ®ÈÄâ</option>
                    </select>
                </div>
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>MCID</th>
                                <th>Brand</th>
                                <th>ASIN</th>
                                <th>Title</th>
                                <th>Price</th>
                                <th>Rating</th>
                                <th>Reviews</th>
                                <th>AI Recommendation</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>398000000000</td>
                                <td>TechBrand</td>
                                <td>B08N5WRWNW</td>
                                <td>Premium Wireless Headphones</td>
                                <td>$49.99</td>
                                <td>4.5</td>
                                <td>2,847</td>
                                <td><span class="recommendation-badge rec-bd">BD</span></td>
                                <td>92%</td>
                            </tr>
                            <tr>
                                <td>563000000000</td>
                                <td>HomeBrand</td>
                                <td>B07XJ8C8F7</td>
                                <td>Smart Home Security System</td>
                                <td>$89.99</td>
                                <td>4.7</td>
                                <td>1,523</td>
                                <td><span class="recommendation-badge rec-ld">LD</span></td>
                                <td>89%</td>
                            </tr>
                            <tr>
                                <td>579000000000</td>
                                <td>FashionCo</td>
                                <td>B09KMJH3RT</td>
                                <td>Designer Luxury Handbag</td>
                                <td>$129.99</td>
                                <td>4.8</td>
                                <td>456</td>
                                <td><span class="recommendation-badge rec-dotd">DOTD</span></td>
                                <td>95%</td>
                            </tr>
                            <tr>
                                <td>784000000000</td>
                                <td>SportsCorp</td>
                                <td>B0A1M2N3O4</td>
                                <td>Professional Fitness Equipment</td>
                                <td>$199.99</td>
                                <td>4.6</td>
                                <td>1,089</td>
                                <td><span class="recommendation-badge rec-ped">PED</span></td>
                                <td>87%</td>
                            </tr>
                            <tr>
                                <td>812000000000</td>
                                <td>BeautyInc</td>
                                <td>B0B5C6D7E8</td>
                                <td>Organic Skincare Set</td>
                                <td>$79.99</td>
                                <td>4.4</td>
                                <td>2,156</td>
                                <td><span class="recommendation-badge rec-bd">BD</span></td>
                                <td>91%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="section">
                <h2>üìä Recommendation Distribution</h2>
                <div class="dashboard-grid">
                    <div class="metric-card">
                        <div class="metric-number">10%</div>
                        <div class="metric-label">Deal of the Day</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number">47%</div>
                        <div class="metric-label">Best Deal (BD)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number">26%</div>
                        <div class="metric-label">Lightning Deal (LD)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-number">17%</div>
                        <div class="metric-label">PED Campaigns</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <div class="section">
                <h2>üìÑ Upload Promotion Submission Data</h2>
                <div id="promotionFileUpload" style="border: 3px dashed #e67e22; border-radius: 10px; padding: 40px; text-align: center; background: #fef9e7; cursor: pointer;" onclick="document.getElementById('promotionFile').click()">
                    <input type="file" id="promotionFile" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileUpload('promotionFile', 'Promotion Submission Data')" />
                    <h3>üìÖ Upload Future 30-Day Promotion Submissions</h3>
                    <p>Upload data showing which ASINs have submitted for promotions</p>
                    <small>Required columns: ASIN, MCID, Promotion_Type, Submission_Date</small>
                    <div id="promotionFileStatus" style="margin-top: 10px; font-weight: bold;"></div>
                </div>
                <button id="mapTargetAsinsBtn" onclick="mapWithTargetAsins()" style="background: linear-gradient(45deg, #e67e22, #d35400); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 15px 5px;">üîÑ Map with Target ASINs</button>
                <div id="mapStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Filter by Marketplace</label>
                <select id="dashboardMarketplaceSelect" onchange="filterDashboardByMarketplace()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 300px;">
                    <option value="all">ÂÖ®ÈÄâ</option>
                </select>
            </div>
            
            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-number" id="totalAsins">0</div>
                    <div class="metric-label">Total Target ASIN# Submitted</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="submissionRate">0%</div>
                    <div class="metric-label">Target ASIN Submission%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="activeMcids">0</div>
                    <div class="metric-label">Total MCID# Submitted</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="revenue">$0</div>
                    <div class="metric-label">Forecasted OPS</div>
                </div>
            </div>
            
            <div class="section">
                <h2>üì¶ Target ASIN Inventory Management</h2>
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ASIN</th>
                                <th>Brand</th>
                                <th>MCID</th>
                                <th>Current Inventory</th>
                                <th>Promotion Type</th>
                                <th>Alert Level</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; color: #7f8c8d; padding: 30px;">Please upload promotion submission data and map with target ASINs to view inventory status</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            

        </div>



        <!-- Performance Tab -->
        <div id="performance" class="tab-content">
            <div class="section">
                <h2>üìà Historical Performance Analysis</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">MCID</label>
                        <select id="mcidSelect" onchange="filterPerformanceData()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;">
                            <option>Select MCID</option>
                            <option value="all">ÂÖ®ÈÄâ</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Brand Name</label>
                        <select id="brandSelect" onchange="filterPerformanceData()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;">
                            <option>Select Brand</option>
                            <option value="all">ÂÖ®ÈÄâ</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Marketplace</label>
                        <select id="performanceMarketplaceSelect" onchange="filterPerformanceData()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;">
                            <option>Select Marketplace</option>
                            <option value="all">ÂÖ®ÈÄâ</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Time Period</label>
                        <select id="timePeriodSelect" onchange="updateChartPeriod()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;">
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                </div>
                <div id="performanceFileUpload" style="border: 3px dashed #9b59b6; border-radius: 10px; padding: 30px; text-align: center; background: #f8f4ff; cursor: pointer; margin: 20px 0;" onclick="document.getElementById('performanceFile').click()">
                    <input type="file" id="performanceFile" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileUpload('performanceFile', 'Performance Data')" />
                    <h3>üìÅ Upload Performance Data</h3>
                    <p>Upload historical promotion performance data for analysis</p>
                    <small>Supported formats: CSV, Excel</small>
                    <div id="performanceFileStatus" style="margin-top: 10px; font-weight: bold;"></div>
                </div>
                <button id="analyzeBtn" onclick="analyzePerformance()" style="background: linear-gradient(45deg, #3498db, #2980b9); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 5px;">üîç Analyze Performance</button>
                <button id="generateReportBtn" onclick="generatePerformanceReport()" style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 5px;">üìÑ Generate Performance Report</button>
                <div id="performanceStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            </div>
            
            <div class="section">
                <h2>üìà Performance Metrics</h2>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 30px; align-items: center;">
                    <!-- Input Module -->
                    <div style="background: #e8f5e8; padding: 25px; border-radius: 15px; border-left: 5px solid #27ae60;">
                        <h3 style="color: #27ae60; margin-bottom: 20px; text-align: center; font-size: 1.3em;">üìä INPUT</h3>
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Total Scheduled ASIN#</span>
                                <span id="perfTotalAsins" style="font-size: 1.2em; font-weight: bold; color: #27ae60;">0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">DOTD ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #e74c3c;">125</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">BD ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #f39c12;">586</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">LD ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #9b59b6;">324</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">PED ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #27ae60;">212</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Coupon ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #17a2b8;">156</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Sales>0 ASIN#</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #28a745;">1,156</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Arrow -->
                    <div style="text-align: center; font-size: 3em; color: #3498db;">
                        ‚û°Ô∏è
                    </div>
                    
                    <!-- Output Module -->
                    <div style="background: #e8f4fd; padding: 25px; border-radius: 15px; border-left: 5px solid #3498db;">
                        <h3 style="color: #3498db; margin-bottom: 20px; text-align: center; font-size: 1.3em;">üí∞ OUTPUT</h3>
                        <div style="display: grid; gap: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Total Promotion OPS</span>
                                <span id="perfTotalOps" style="font-size: 1.2em; font-weight: bold; color: #3498db;">$0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">DOTD OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #e74c3c;">$890K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">BD OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #f39c12;">$756K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">LD OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #9b59b6;">$523K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">PED OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #27ae60;">$271K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Coupon OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #17a2b8;">$189K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: white; border-radius: 8px;">
                                <span style="font-weight: 600;">Others OPS</span>
                                <span style="font-size: 1.2em; font-weight: bold; color: #6c757d;">$45K</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2 id="chartTitle">üìâ Weekly Promotion OPS Trend</h2>
                <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); height: 400px;">
                    <canvas id="opsChart" width="800" height="300"></canvas>
                    <div id="chartDescription" style="text-align: center; margin-top: 15px; color: #7f8c8d; font-size: 0.9em;">
                        üìà <strong>Blue Line:</strong> 2025 Weekly Promotion OPS | <strong>Gray Line:</strong> 2024 YOY Comparison
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Automation Tab -->
        <div id="email-automation" class="tab-content">
            <div class="section">
                <h2>üìß Email Template Editor</h2>
                <div style="margin-bottom: 20px;">
                    <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Report Type</label>
                    <select id="reportTypeSelect" onchange="updateEmailTemplate()" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 300px;">
                        <option value="sourcing">Target ASIN Sourcing Report</option>
                        <option value="performance">Promotion Performance Report</option>
                    </select>
                </div>
                <div>
                    <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Email Template</label>
                    <textarea rows="12" style="width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 8px; font-family: monospace; resize: vertical;">Dear Valued Partner,

We are pleased to provide you with personalized promotion recommendations for your products based on our advanced AI analysis.

Account Summary:
‚Ä¢ Account (MCID): {mcid}
‚Ä¢ Brand: {brand}
‚Ä¢ Marketplace: {marketplace}
‚Ä¢ Total ASINs Analyzed: {asin_count}

Promotion Recommendations:
‚Ä¢ Deal of the Day (DOTD): {dotd_count} ASINs
‚Ä¢ Best Deal (BD): {bd_count} ASINs
‚Ä¢ Lightning Deal (LD): {ld_count} ASINs
‚Ä¢ PED Campaigns: {ped_count} ASINs

Please find the detailed ASIN recommendations in the attached Excel file. Each ASIN has been carefully analyzed using our proprietary algorithm to ensure optimal promotion performance.

Next Steps:
1. Review the attached recommendations
2. Select ASINs for your preferred promotion types
3. Submit campaigns through Seller Central
4. Monitor performance using our analytics dashboard

If you have any questions or need assistance with campaign setup, please don't hesitate to reach out to our team.

Best regards,
Your Account Manager

Attachment: {mcid}_{brand}_{marketplace}_Recommendations.xlsx</textarea>
                </div>
                <button style="background: linear-gradient(45deg, #3498db, #2980b9); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 15px 5px;">üëÄ Preview Email</button>
            </div>
            
            <div class="section">
                <h2>üìé Additional Attachments</h2>
                <div style="border: 3px dashed #3498db; border-radius: 10px; padding: 40px; text-align: center; background: #f8f9ff; cursor: pointer;">
                    <h3>üìé Add Extra Attachments (Max 3)</h3>
                    <p>Click to select additional files to attach</p>
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px;">
                    <div style="background: #ecf0f1; padding: 8px 15px; border-radius: 20px; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                        üìÑ promotion_guidelines.pdf
                        <button style="background: #e74c3c; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px;">√ó</button>
                    </div>
                    <div style="background: #ecf0f1; padding: 8px 15px; border-radius: 20px; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                        üìä market_analysis.xlsx
                        <button style="background: #e74c3c; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px;">√ó</button>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üéØ MCID Email Mapping</h2>
                <div>
                    <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">MCID to Email Mapping</label>
                    <textarea rows="6" placeholder="Format: MCID,email@company.com (one per line)" style="width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px;">398000000000,seller1@company.com
563000000000,seller2@company.com
579000000000,seller3@company.com</textarea>
                </div>
            </div>
            
            <div class="section">
                <h2>üì§ Email Configuration</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Sender Email</label>
                        <input type="email" placeholder="your-email@company.com" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;" />
                    </div>
                    <div>
                        <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Email Method</label>
                        <select style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 100%;">
                            <option>Outlook Integration</option>
                            <option>SMTP Server</option>
                        </select>
                    </div>
                </div>
                <button onclick="sendBulkEmails()" style="background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; padding: 15px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; margin: 20px 5px;">üìß Send Bulk Emails</button>
                <div id="emailStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            </div>
        </div>

        <!-- HVE Analysis Tab -->
        <div id="hve-analysis" class="tab-content">
            <div class="section">
                <h2>üìÑ Upload HVE Data</h2>
                <div id="hveFileUpload" style="border: 3px dashed #8e44ad; border-radius: 10px; padding: 40px; text-align: center; background: #f8f4ff; cursor: pointer;" onclick="document.getElementById('hveFile').click()">
                    <input type="file" id="hveFile" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleFileUpload('hveFile', 'HVE Performance Data')" />
                    <h3>üìÅ Upload HVE Performance Data</h3>
                    <p>Upload historical HVE data for comprehensive analysis</p>
                    <small>Required columns: PG, GL, ASIN, ASIN_Age, ASP_Band, Marketplace, Promotion_Type, OPS, Units_Sold</small>
                    <div id="hveFileStatus" style="margin-top: 10px; font-weight: bold;"></div>
                </div>
                <button id="processHveBtn" onclick="processHveData()" style="background: linear-gradient(45deg, #8e44ad, #9b59b6); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; margin: 15px 5px;">üöÄ Process HVE Data</button>
                <div id="hveProcessStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
                
                <div style="margin-top: 20px;">
                    <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">Filter by Marketplace</label>
                    <select id="hveMarketplaceSelect" style="padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; width: 300px;">
                        <option>Select Marketplace</option>
                        <option value="all">ÂÖ®ÈÄâ</option>
                        <option value="US">US</option>
                        <option value="UK">UK</option>
                        <option value="DE">DE</option>
                        <option value="FR">FR</option>
                        <option value="CA">CA</option>
                        <option value="JP">JP</option>
                    </select>
                </div>
            </div>
            
            <div class="section">
                <h2>üìà Performance Analysis</h2>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr auto 1fr; gap: 20px; align-items: center;">
                    <!-- Input Module -->
                    <div style="background: #e8f5e8; padding: 20px; border-radius: 15px; border-left: 5px solid #27ae60;">
                        <h3 style="color: #27ae60; margin-bottom: 15px; text-align: center; font-size: 1.1em;">üìä INPUT</h3>
                        <div style="display: grid; gap: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Total Scheduled ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #27ae60;">2,847<br><small style="color: #27ae60;">+20% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">DOTD ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #e74c3c;">285<br><small style="color: #27ae60;">+15% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">BD ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #f39c12;">1,338<br><small style="color: #27ae60;">+18% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">LD ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #9b59b6;">740<br><small style="color: #27ae60;">+22% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">PED ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #27ae60;">484<br><small style="color: #27ae60;">+12% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Coupon ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #17a2b8;">356<br><small style="color: #e74c3c;">-3% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Sales>0 ASIN#</span>
                                <span style="font-size: 1em; font-weight: bold; color: #28a745;">2,634<br><small style="color: #27ae60;">+25% YOY</small></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Arrow 1 -->
                    <div style="text-align: center; font-size: 2em; color: #3498db;">
                        ‚û°Ô∏è
                    </div>
                    
                    <!-- Output Module -->
                    <div style="background: #e8f4fd; padding: 20px; border-radius: 15px; border-left: 5px solid #3498db;">
                        <h3 style="color: #3498db; margin-bottom: 15px; text-align: center; font-size: 1.1em;">üí∞ OUTPUT</h3>
                        <div style="display: grid; gap: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Total Promotion OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #3498db;">$5.8M<br><small style="color: #27ae60;">+32% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">DOTD OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #e74c3c;">$2.1M<br><small style="color: #27ae60;">+28% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">BD OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #f39c12;">$1.8M<br><small style="color: #27ae60;">+35% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">LD OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #9b59b6;">$1.2M<br><small style="color: #27ae60;">+41% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">PED OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #27ae60;">$620K<br><small style="color: #27ae60;">+19% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Coupon OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #17a2b8;">$432K<br><small style="color: #e74c3c;">-8% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Others OPS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #6c757d;">$98K<br><small style="color: #27ae60;">+5% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Avg PQS</span>
                                <span style="font-size: 1em; font-weight: bold; color: #8e44ad;">4.2<br><small style="color: #27ae60;">+8% YOY</small></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Arrow 2 -->
                    <div style="text-align: center; font-size: 2em; color: #e74c3c;">
                        ‚û°Ô∏è
                    </div>
                    
                    <!-- Productivity Module -->
                    <div style="background: #fdf2e9; padding: 20px; border-radius: 15px; border-left: 5px solid #e67e22;">
                        <h3 style="color: #e67e22; margin-bottom: 15px; text-align: center; font-size: 1.1em;">üìà PRODUCTIVITY</h3>
                        <div style="display: grid; gap: 10px;">

                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">DOTD OPS/ASIN</span>
                                <span style="font-size: 1em; font-weight: bold; color: #e74c3c;">$7,368<br><small style="color: #27ae60;">+11% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">BD OPS/ASIN</span>
                                <span style="font-size: 1em; font-weight: bold; color: #f39c12;">$1,345<br><small style="color: #27ae60;">+14% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">LD OPS/ASIN</span>
                                <span style="font-size: 1em; font-weight: bold; color: #9b59b6;">$1,622<br><small style="color: #27ae60;">+17% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">PED OPS/ASIN</span>
                                <span style="font-size: 1em; font-weight: bold; color: #27ae60;">$1,281<br><small style="color: #27ae60;">+6% YOY</small></span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 6px;">
                                <span style="font-weight: 600; font-size: 13px;">Coupon OPS/ASIN</span>
                                <span style="font-size: 1em; font-weight: bold; color: #17a2b8;">$1,213<br><small style="color: #e74c3c;">-5% YOY</small></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>üèÜ Top ASIN Performance</h2>
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>ASIN</th>
                                <th>Deal Type</th>
                                <th>Promotion OPS</th>
                                <th>Sold Units</th>
                                <th>OPS per Unit</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>B08N5WRWNW</td>
                                <td><span class="recommendation-badge rec-dotd">DOTD</span></td>
                                <td>$89,500</td>
                                <td>1,247</td>
                                <td>$71.78</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>B07XJ8C8F7</td>
                                <td><span class="recommendation-badge rec-bd">BD</span></td>
                                <td>$76,200</td>
                                <td>856</td>
                                <td>$89.02</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>B09KMJH3RT</td>
                                <td><span class="recommendation-badge rec-ld">LD</span></td>
                                <td>$68,900</td>
                                <td>534</td>
                                <td>$129.03</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>B0A1M2N3O4</td>
                                <td><span class="recommendation-badge rec-ped">PED</span></td>
                                <td>$54,300</td>
                                <td>723</td>
                                <td>$75.10</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>B0B5C6D7E8</td>
                                <td><span class="recommendation-badge rec-bd">BD</span></td>
                                <td>$47,800</td>
                                <td>612</td>
                                <td>$78.10</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="section">
                <h2>üîç PG-ASP Cross-dimensional Insights</h2>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #8e44ad; margin-bottom: 15px;">üî• YOY% Growth by PG and ASP Band</h3>
                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <div style="display: grid; grid-template-columns: 100px repeat(8, 1fr); gap: 2px; font-size: 12px;">
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">PG \ ASP</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">0-10</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">10-15</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">15-20</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">20-30</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">30-50</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">50-100</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">100-200</div>
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">>200</div>
                            
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">CE</div>
                            <div style="background: #f1c40f; padding: 10px; text-align: center; font-weight: bold;">-9</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">52</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">57</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">48</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">53</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">47</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">58</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">49</div>
                            
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">Consumables</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">72</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">58</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">55</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">73</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">53</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">23</div>
                            <div style="background: #e74c3c; color: white; padding: 10px; text-align: center; font-weight: bold;">-14</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">80</div>
                            
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">Hardlines</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">68</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">57</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">60</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">60</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">56</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">47</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">35</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">26</div>
                            
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">Media</div>
                            <div style="background: #16a085; color: white; padding: 10px; text-align: center; font-weight: bold;">918</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">31</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">73</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">24</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">25</div>
                            <div style="background: #16a085; color: white; padding: 10px; text-align: center; font-weight: bold;">140</div>
                            <div style="background: #e74c3c; color: white; padding: 10px; text-align: center; font-weight: bold;">-49</div>
                            <div style="background: #f1c40f; padding: 10px; text-align: center; font-weight: bold;">8</div>
                            
                            <div style="background: #34495e; color: white; padding: 10px; text-align: center; font-weight: bold;">Softlines</div>
                            <div style="background: #16a085; color: white; padding: 10px; text-align: center; font-weight: bold;">161</div>
                            <div style="background: #16a085; color: white; padding: 10px; text-align: center; font-weight: bold;">119</div>
                            <div style="background: #27ae60; padding: 10px; text-align: center; font-weight: bold;">79</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">47</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">54</div>
                            <div style="background: #2ecc71; padding: 10px; text-align: center; font-weight: bold;">57</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">20</div>
                            <div style="background: #f39c12; padding: 10px; text-align: center; font-weight: bold;">24</div>
                        </div>
                        <div style="margin-top: 15px; text-align: center; color: #7f8c8d; font-size: 0.9em;">
                            üìà Heat Map: Green = High Growth (>50%), Yellow = Moderate Growth (0-50%), Red = Decline (<0%)
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #8e44ad; margin-bottom: 15px;">üìà GL-ASIN Age Insights</h3>
                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); height: 400px;">
                        <canvas id="glAsinAgeChart" width="800" height="300"></canvas>
                        <div style="text-align: center; margin-top: 15px; color: #7f8c8d; font-size: 0.9em;">
                            üìà GL Performance by ASIN Age: Green (0-3M), Blue (3-12M), Orange (12M+)
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 style="color: #8e44ad; margin-bottom: 15px;">üìä Key Insights</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: #d5f4e6; padding: 20px; border-radius: 10px; border-left: 5px solid #27ae60;">
                            <h4 style="color: #27ae60; margin-bottom: 10px;">üéÜ Highest New Product Acceptance GL</h4>
                            <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">Camera</p>
                            <p style="color: #7f8c8d; font-size: 0.9em;">0-3M ASIN YOY Growth: +156%</p>
                        </div>
                        <div style="background: #ffeaa7; padding: 20px; border-radius: 10px; border-left: 5px solid #f39c12;">
                            <h4 style="color: #f39c12; margin-bottom: 10px;">‚ö†Ô∏è Weak New Product Growth GL</h4>
                            <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">Electronics</p>
                            <p style="color: #7f8c8d; font-size: 0.9em;">0-3M ASIN YOY Growth: <5%</p>
                        </div>
                        <div style="background: #ddd6fe; padding: 20px; border-radius: 10px; border-left: 5px solid #8e44ad;">
                            <h4 style="color: #8e44ad; margin-bottom: 10px;">üìà Stable Growth GL</h4>
                            <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">Office Products, PC</p>
                            <p style="color: #7f8c8d; font-size: 0.9em;">Stable growth across all age segments</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        </div>
        
        <div class="footer">
            <h3>üöÄ Zero-Touch Merch Campaign Engine</h3>
            <p>Revolutionizing Account Manager workflows through intelligent automation</p>
            <p style="margin-top: 15px; opacity: 0.8;">
                <strong>Impact:</strong> 80% time reduction ‚Ä¢ 150+ hours saved weekly ‚Ä¢ 94% recommendation accuracy
            </p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let uploadedFiles = {
            dataFile: null,
            dotdFile: null
        };
        
        let processedData = {
            targetAsins: [],
            dotdAsins: [],
            recommendations: {
                dotd: 0,
                bd: 0,
                ld: 0,
                ped: 0
            },
            marketplaces: new Set(),
            mcids: new Set(),
            brands: new Set()
        };
        
        let promotionSubmissions = [];
        let dashboardFiltered = { marketplace: 'all' };
        let performanceData = [];
        let performanceFiltered = { mcid: 'all', brand: 'all', marketplace: 'all' };
        let hveData = [];
        let hveProcessed = false;

        function handleFileUpload(fileId, fileName) {
            const fileInput = document.getElementById(fileId);
            const statusDiv = document.getElementById(fileId + 'Status');
            const uploadDiv = document.getElementById(fileId + 'Upload');
            
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                uploadedFiles[fileId] = file;
                
                statusDiv.innerHTML = `‚úÖ ${file.name} (${(file.size/1024).toFixed(1)}KB)`;
                statusDiv.style.color = '#27ae60';
                
                uploadDiv.style.borderColor = '#27ae60';
                if (fileId === 'promotionFile') {
                    uploadDiv.style.background = '#f0fff4';
                } else {
                    uploadDiv.style.background = '#f0fff4';
                }
            }
        }

        function processData() {
            const processBtn = document.getElementById('processBtn');
            const processStatus = document.getElementById('processStatus');
            
            if (!uploadedFiles.dataFile) {
                processStatus.innerHTML = '‚ùå Please upload Target ASIN Data first';
                processStatus.style.background = '#f8d7da';
                processStatus.style.color = '#721c24';
                processStatus.style.display = 'block';
                return;
            }
            
            // Show processing
            processBtn.innerHTML = '‚è≥ Processing...';
            processBtn.disabled = true;
            processStatus.innerHTML = 'üîÑ Analyzing data and generating AI recommendations...';
            processStatus.style.background = '#d1ecf1';
            processStatus.style.color = '#0c5460';
            processStatus.style.display = 'block';
            
            // Simulate processing
            setTimeout(() => {
                generateMockData();
                updateAsinTable();
                updateMarketplaceFilter();
                updateRecommendationDistribution();
                updateEmailMappings();
                
                processBtn.innerHTML = 'üöÄ Process Data & Generate AI Recommendations';
                processBtn.disabled = false;
                
                const dataFileCount = processedData.targetAsins.length;
                const dotdFileCount = processedData.dotdAsins.length;
                
                processStatus.innerHTML = `‚úÖ Processing Complete!<br>
                üìä Processed ${dataFileCount} Target ASINs<br>
                üî• Processed ${dotdFileCount} DOTD ASINs<br>
                ü§ñ Generated AI recommendations with 89% average confidence<br>
                üìã Results updated in table below`;
                processStatus.style.background = '#d4edda';
                processStatus.style.color = '#155724';
            }, 3000);
        }
        
        function generateMockData() {
            const marketplaces = ['US', 'UK', 'DE', 'FR', 'CA', 'JP'];
            const brands = ['TechBrand', 'HomeBrand', 'FashionCo', 'SportsCorp', 'BeautyInc', 'KitchenPro', 'AutoParts', 'BookWorld'];
            const mcids = ['398000000000', '563000000000', '579000000000', '784000000000', '812000000000', '923000000000', '456000000000', '678000000000'];
            
            processedData.targetAsins = [];
            processedData.dotdAsins = [];
            processedData.recommendations = { dotd: 0, bd: 0, ld: 0, ped: 0 };
            processedData.marketplaces.clear();
            processedData.mcids.clear();
            processedData.brands.clear();
            
            // Generate target ASINs
            for (let i = 0; i < 50; i++) {
                const marketplace = marketplaces[Math.floor(Math.random() * marketplaces.length)];
                const brand = brands[Math.floor(Math.random() * brands.length)];
                const mcid = mcids[Math.floor(Math.random() * mcids.length)];
                const asin = 'B' + Math.random().toString(36).substr(2, 9).toUpperCase();
                const price = (Math.random() * 200 + 10).toFixed(2);
                const rating = (Math.random() * 1.5 + 3.5).toFixed(1);
                const reviews = Math.floor(Math.random() * 5000 + 100);
                
                let recommendation = 'BD';
                if (uploadedFiles.dotdFile && Math.random() < 0.1) {
                    recommendation = 'DOTD';
                    processedData.dotdAsins.push(asin);
                } else if (parseFloat(rating) >= 4.5 && Math.random() < 0.3) {
                    recommendation = 'LD';
                } else if (parseFloat(rating) < 4.0 && Math.random() < 0.2) {
                    recommendation = 'PED';
                }
                
                processedData.recommendations[recommendation.toLowerCase()]++;
                
                processedData.targetAsins.push({
                    mcid, brand, asin, marketplace, price, rating, reviews, recommendation,
                    title: `Premium Product ${i + 1}`,
                    confidence: Math.floor(Math.random() * 15 + 85)
                });
                
                processedData.marketplaces.add(marketplace);
                processedData.mcids.add(mcid);
                processedData.brands.add(brand);
            }
        }
        
        function updateAsinTable() {
            const tbody = document.querySelector('.data-table tbody');
            tbody.innerHTML = '';
            
            processedData.targetAsins.slice(0, 10).forEach(asin => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${asin.mcid}</td>
                    <td>${asin.brand}</td>
                    <td>${asin.asin}</td>
                    <td>${asin.title}</td>
                    <td>$${asin.price}</td>
                    <td>${asin.rating}</td>
                    <td>${asin.reviews.toLocaleString()}</td>
                    <td><span class="recommendation-badge rec-${asin.recommendation.toLowerCase()}">${asin.recommendation}</span></td>
                    <td>${asin.confidence}%</td>
                `;
                row.dataset.marketplace = asin.marketplace;
            });
        }
        
        function updateMarketplaceFilter() {
            const select = document.getElementById('asinMarketplaceSelect');
            const currentValue = select.value;
            
            // Clear existing options except first two
            while (select.children.length > 2) {
                select.removeChild(select.lastChild);
            }
            
            // Add marketplace options
            Array.from(processedData.marketplaces).sort().forEach(marketplace => {
                const option = document.createElement('option');
                option.value = marketplace;
                option.textContent = marketplace;
                select.appendChild(option);
            });
            
            select.value = currentValue;
        }
        
        function updateRecommendationDistribution() {
            const total = processedData.targetAsins.length;
            if (total === 0) return;
            
            const cards = document.querySelectorAll('#data-management .metric-card .metric-number');
            cards[0].textContent = Math.round((processedData.recommendations.dotd / total) * 100) + '%';
            cards[1].textContent = Math.round((processedData.recommendations.bd / total) * 100) + '%';
            cards[2].textContent = Math.round((processedData.recommendations.ld / total) * 100) + '%';
            cards[3].textContent = Math.round((processedData.recommendations.ped / total) * 100) + '%';
        }
        
        function updateEmailMappings() {
            const textarea = document.querySelector('#email-automation textarea[placeholder*="MCID"]');
            let mappings = [];
            
            Array.from(processedData.mcids).forEach((mcid, index) => {
                mappings.push(`${mcid},seller${index + 1}@company.com`);
            });
            
            textarea.value = mappings.join('\n');
        }
        
        function mapWithTargetAsins() {
            const mapBtn = document.getElementById('mapTargetAsinsBtn');
            const mapStatus = document.getElementById('mapStatus');
            
            if (processedData.targetAsins.length === 0) {
                mapStatus.innerHTML = '‚ùå Please process Target ASIN data first in the Target ASIN Sourcing Engine tab';
                mapStatus.style.background = '#f8d7da';
                mapStatus.style.color = '#721c24';
                mapStatus.style.display = 'block';
                return;
            }
            
            if (!uploadedFiles.promotionFile) {
                mapStatus.innerHTML = '‚ùå Please upload promotion submission data first';
                mapStatus.style.background = '#f8d7da';
                mapStatus.style.color = '#721c24';
                mapStatus.style.display = 'block';
                return;
            }
            
            mapBtn.innerHTML = '‚è≥ Mapping...';
            mapBtn.disabled = true;
            mapStatus.innerHTML = 'üîÑ Mapping promotion submissions with target ASINs...';
            mapStatus.style.background = '#d1ecf1';
            mapStatus.style.color = '#0c5460';
            mapStatus.style.display = 'block';
            
            setTimeout(() => {
                generatePromotionSubmissions();
                updateDashboardMarketplaceFilter();
                updateDashboardMetrics();
                updateInventoryTable();
                
                mapBtn.innerHTML = 'üîÑ Map with Target ASINs';
                mapBtn.disabled = false;
                
                mapStatus.innerHTML = `‚úÖ Mapping Complete!<br>
                üìä Mapped ${promotionSubmissions.length} promotion submissions<br>
                üéØ Found ${new Set(promotionSubmissions.map(p => p.asin)).size} unique target ASINs<br>
                üìà Dashboard metrics updated`;
                mapStatus.style.background = '#d4edda';
                mapStatus.style.color = '#155724';
            }, 2000);
        }
        
        function analyzePerformance() {
            const analyzeBtn = document.getElementById('analyzeBtn');
            const performanceStatus = document.getElementById('performanceStatus');
            
            if (!uploadedFiles.performanceFile) {
                performanceStatus.innerHTML = '‚ùå Please upload performance data first';
                performanceStatus.style.background = '#f8d7da';
                performanceStatus.style.color = '#721c24';
                performanceStatus.style.display = 'block';
                return;
            }
            
            analyzeBtn.innerHTML = '‚è≥ Analyzing...';
            analyzeBtn.disabled = true;
            performanceStatus.innerHTML = 'üîÑ Analyzing performance data and generating insights...';
            performanceStatus.style.background = '#d1ecf1';
            performanceStatus.style.color = '#0c5460';
            performanceStatus.style.display = 'block';
            
            setTimeout(() => {
                generatePerformanceData();
                updatePerformanceFilters();
                updatePerformanceMetrics();
                updateChartData();
                
                analyzeBtn.innerHTML = 'üîç Analyze Performance';
                analyzeBtn.disabled = false;
                
                performanceStatus.innerHTML = `‚úÖ Analysis Complete!<br>
                üìä Analyzed ${performanceData.length} performance records<br>
                üìà Updated metrics and charts<br>
                üìä Performance insights generated`;
                performanceStatus.style.background = '#d4edda';
                performanceStatus.style.color = '#155724';
            }, 3000);
        }
        
        function generatePerformanceReport() {
            const generateBtn = document.getElementById('generateReportBtn');
            const performanceStatus = document.getElementById('performanceStatus');
            
            if (performanceData.length === 0) {
                performanceStatus.innerHTML = '‚ùå Please analyze performance data first';
                performanceStatus.style.background = '#f8d7da';
                performanceStatus.style.color = '#721c24';
                performanceStatus.style.display = 'block';
                return;
            }
            
            generateBtn.innerHTML = '‚è≥ Generating...';
            generateBtn.disabled = true;
            performanceStatus.innerHTML = 'üìÑ Generating performance report and updating email templates...';
            performanceStatus.style.background = '#d1ecf1';
            performanceStatus.style.color = '#0c5460';
            performanceStatus.style.display = 'block';
            
            setTimeout(() => {
                updateEmailTemplateWithPerformance();
                
                generateBtn.innerHTML = 'üìÑ Generate Performance Report';
                generateBtn.disabled = false;
                
                performanceStatus.innerHTML = `‚úÖ Report Generated!<br>
                üìÑ Performance report created<br>
                üìß Email templates updated<br>
                üìä Ready for email automation`;
                performanceStatus.style.background = '#d4edda';
                performanceStatus.style.color = '#155724';
            }, 2000);
        }
        
        function generatePerformanceData() {
            performanceData = [];
            const marketplaces = ['US', 'UK', 'DE', 'FR', 'CA', 'JP'];
            const brands = ['TechBrand', 'HomeBrand', 'FashionCo', 'SportsCorp', 'BeautyInc'];
            const mcids = ['398000000000', '563000000000', '579000000000', '784000000000', '812000000000'];
            const promotionTypes = ['DOTD', 'BD', 'LD', 'PED'];
            
            for (let i = 0; i < 100; i++) {
                const marketplace = marketplaces[Math.floor(Math.random() * marketplaces.length)];
                const brand = brands[Math.floor(Math.random() * brands.length)];
                const mcid = mcids[Math.floor(Math.random() * mcids.length)];
                const promotionType = promotionTypes[Math.floor(Math.random() * promotionTypes.length)];
                
                performanceData.push({
                    mcid,
                    brand,
                    marketplace,
                    promotionType,
                    asin: 'B' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                    ops: Math.floor(Math.random() * 100000 + 10000),
                    units: Math.floor(Math.random() * 1000 + 50),
                    date: new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]
                });
            }
        }
        
        function updatePerformanceFilters() {
            const mcidSelect = document.getElementById('mcidSelect');
            const brandSelect = document.getElementById('brandSelect');
            const marketplaceSelect = document.getElementById('performanceMarketplaceSelect');
            
            // Clear existing options except first two
            [mcidSelect, brandSelect, marketplaceSelect].forEach(select => {
                while (select.children.length > 2) {
                    select.removeChild(select.lastChild);
                }
            });
            
            // Add unique values
            const uniqueMcids = [...new Set(performanceData.map(p => p.mcid))];
            const uniqueBrands = [...new Set(performanceData.map(p => p.brand))];
            const uniqueMarketplaces = [...new Set(performanceData.map(p => p.marketplace))];
            
            uniqueMcids.forEach(mcid => {
                const option = document.createElement('option');
                option.value = mcid;
                option.textContent = mcid;
                mcidSelect.appendChild(option);
            });
            
            uniqueBrands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
            
            uniqueMarketplaces.forEach(marketplace => {
                const option = document.createElement('option');
                option.value = marketplace;
                option.textContent = marketplace;
                marketplaceSelect.appendChild(option);
            });
        }
        
        function filterPerformanceData() {
            performanceFiltered.mcid = document.getElementById('mcidSelect').value;
            performanceFiltered.brand = document.getElementById('brandSelect').value;
            performanceFiltered.marketplace = document.getElementById('performanceMarketplaceSelect').value;
            
            updatePerformanceMetrics();
            updateChartData();
        }
        
        function updatePerformanceMetrics() {
            let filteredData = performanceData;
            
            if (performanceFiltered.mcid !== 'all' && performanceFiltered.mcid !== 'Select MCID') {
                filteredData = filteredData.filter(p => p.mcid === performanceFiltered.mcid);
            }
            if (performanceFiltered.brand !== 'all' && performanceFiltered.brand !== 'Select Brand') {
                filteredData = filteredData.filter(p => p.brand === performanceFiltered.brand);
            }
            if (performanceFiltered.marketplace !== 'all' && performanceFiltered.marketplace !== 'Select Marketplace') {
                filteredData = filteredData.filter(p => p.marketplace === performanceFiltered.marketplace);
            }
            
            const totalAsins = filteredData.length;
            const totalOps = filteredData.reduce((sum, p) => sum + p.ops, 0);
            
            document.getElementById('perfTotalAsins').textContent = totalAsins.toLocaleString();
            document.getElementById('perfTotalOps').textContent = '$' + (totalOps / 1000000).toFixed(1) + 'M';
            
            // Update other metrics
            const promotionCounts = { dotd: 0, bd: 0, ld: 0, ped: 0 };
            const promotionOps = { dotd: 0, bd: 0, ld: 0, ped: 0 };
            
            filteredData.forEach(p => {
                const type = p.promotionType.toLowerCase();
                promotionCounts[type]++;
                promotionOps[type] += p.ops;
            });
            
            const inputMetrics = document.querySelectorAll('#performance .section:nth-child(2) .metric-number');
            if (inputMetrics.length >= 7) {
                inputMetrics[0].textContent = totalAsins.toLocaleString();
                inputMetrics[1].textContent = promotionCounts.dotd;
                inputMetrics[2].textContent = promotionCounts.bd;
                inputMetrics[3].textContent = promotionCounts.ld;
                inputMetrics[4].textContent = promotionCounts.ped;
            }
            
            const outputMetrics = document.querySelectorAll('#performance .section:nth-child(2) .metric-number');
            if (outputMetrics.length >= 14) {
                outputMetrics[7].textContent = '$' + (totalOps / 1000000).toFixed(1) + 'M';
                outputMetrics[8].textContent = '$' + (promotionOps.dotd / 1000).toFixed(0) + 'K';
                outputMetrics[9].textContent = '$' + (promotionOps.bd / 1000).toFixed(0) + 'K';
                outputMetrics[10].textContent = '$' + (promotionOps.ld / 1000).toFixed(0) + 'K';
                outputMetrics[11].textContent = '$' + (promotionOps.ped / 1000).toFixed(0) + 'K';
            }
        }
        
        function updateEmailTemplateWithPerformance() {
            const reportTypeSelect = document.getElementById('reportTypeSelect');
            reportTypeSelect.value = 'performance';
            updateEmailTemplate();
        }
        
        function processHveData() {
            const processBtn = document.getElementById('processHveBtn');
            const processStatus = document.getElementById('hveProcessStatus');
            
            if (!uploadedFiles.hveFile) {
                processStatus.innerHTML = '‚ùå Please upload HVE data first';
                processStatus.style.background = '#f8d7da';
                processStatus.style.color = '#721c24';
                processStatus.style.display = 'block';
                return;
            }
            
            processBtn.innerHTML = '‚è≥ Processing...';
            processBtn.disabled = true;
            processStatus.innerHTML = 'üîÑ Processing HVE data and generating insights...';
            processStatus.style.background = '#d1ecf1';
            processStatus.style.color = '#0c5460';
            processStatus.style.display = 'block';
            
            setTimeout(() => {
                generateHveData();
                updateHveAnalysis();
                updateGLAsinAgeChart();
                
                processBtn.innerHTML = 'üöÄ Process HVE Data';
                processBtn.disabled = false;
                
                processStatus.innerHTML = `‚úÖ HVE Processing Complete!<br>
                üìä Processed ${hveData.length} HVE records<br>
                üîç Generated cross-dimensional insights<br>
                üìà Updated GL-ASIN age analysis`;
                processStatus.style.background = '#d4edda';
                processStatus.style.color = '#155724';
                hveProcessed = true;
            }, 3000);
        }
        
        function generateHveData() {
            hveData = [];
            const glNames = ['Camera', 'Electronics', 'Home Entertainment', 'Mobile_Electronics', 'Musical Instruments', 'Office Products', 'PC', 'Wireless', 'Baby', 'Beauty', 'Gourmet', 'Grocery', 'Health & Personal Care', 'Luxury Beauty', 'Personal_Care_Appliances', 'Wine', 'gl_fresh_perishable', 'gl_fresh_prepared', 'gl_fresh_produce', 'gl_protein', 'Art', 'Art and Craft Supplies', 'Automotive', 'Biss', 'Entertainment Collectibles', 'Furniture', 'GUILD', 'Home', 'Home Improvement', 'Kitchen', 'Lawn and Garden', 'Major Appliances', 'Outdoors', 'Pet Products', 'Sports', 'Sports Memorabilia', 'Tires', 'Tools', 'Toys', 'Books', 'Gifts', 'Magazines', 'Music', 'Photo', 'Software', 'Video DVD', 'Video Games', 'Apparel', 'Designer Apparel', 'Jewelry', 'Luggage', 'Media', 'Shoes', 'Softlines Private Label', 'Watches'];
            const pgNames = ['Softlines', 'CE', 'MEDIA', 'HARDLINES', 'CONSUMABLES'];
            const marketplaces = ['US', 'UK', 'DE', 'FR', 'CA', 'JP'];
            const promotionTypes = ['DOTD', 'BD', 'LD', 'PED'];
            const asinAges = ['0-3M', '3-12M', '12M+'];
            
            for (let i = 0; i < 200; i++) {
                const gl = glNames[Math.floor(Math.random() * glNames.length)];
                const pg = pgNames[Math.floor(Math.random() * pgNames.length)];
                const marketplace = marketplaces[Math.floor(Math.random() * marketplaces.length)];
                const promotionType = promotionTypes[Math.floor(Math.random() * promotionTypes.length)];
                const asinAge = asinAges[Math.floor(Math.random() * asinAges.length)];
                
                hveData.push({
                    gl: gl,  // This is the GL (55 options)
                    pg: pg,  // This is the PG (5 options)
                    marketplace: marketplace,
                    promotionType: promotionType,
                    asinAge: asinAge,
                    asin: 'B' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                    ops: Math.floor(Math.random() * 100000 + 10000),
                    units: Math.floor(Math.random() * 1000 + 50),
                    yoyGrowth: Math.floor(Math.random() * 200 - 50) // -50 to +150
                });
            }
        }
        
        function updateHveAnalysis() {
            // Update top ASIN performance table with HVE data
            const tbody = document.querySelector('#hve-analysis .data-table tbody');
            tbody.innerHTML = '';
            
            const topAsins = hveData.sort((a, b) => b.ops - a.ops).slice(0, 5);
            topAsins.forEach((asin, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${asin.asin}</td>
                    <td><span class="recommendation-badge rec-${asin.promotionType.toLowerCase()}">${asin.promotionType}</span></td>
                    <td>$${asin.ops.toLocaleString()}</td>
                    <td>${asin.units.toLocaleString()}</td>
                    <td>$${(asin.ops / asin.units).toFixed(2)}</td>
                `;
            });
            
            // Generate intelligent insights
            generateIntelligentInsights();
        }
        
        function generateIntelligentInsights() {
            if (!hveData || hveData.length === 0) return;
            
            // Analyze data for insights
            const glPerformance = {};
            const agePerformance = { '0-3M': [], '3-12M': [], '12M+': [] };
            const promotionPerformance = { 'DOTD': [], 'BD': [], 'LD': [], 'PED': [] };
            
            hveData.forEach(item => {
                // GL analysis
                if (!glPerformance[item.gl]) {
                    glPerformance[item.gl] = { growth: [], ops: [] };
                }
                glPerformance[item.gl].growth.push(item.yoyGrowth);
                glPerformance[item.gl].ops.push(item.ops);
                
                // Age analysis
                agePerformance[item.asinAge].push(item.yoyGrowth);
                
                // Promotion analysis
                promotionPerformance[item.promotionType].push(item.ops);
            });
            
            // Find best performing GL
            let bestGL = '';
            let bestGrowth = -Infinity;
            let worstGL = '';
            let worstGrowth = Infinity;
            
            Object.keys(glPerformance).forEach(gl => {
                const avgGrowth = glPerformance[gl].growth.reduce((a, b) => a + b, 0) / glPerformance[gl].growth.length;
                if (avgGrowth > bestGrowth) {
                    bestGrowth = avgGrowth;
                    bestGL = gl;
                }
                if (avgGrowth < worstGrowth) {
                    worstGrowth = avgGrowth;
                    worstGL = gl;
                }
            });
            
            // Find best age segment
            let bestAge = '';
            let bestAgeGrowth = -Infinity;
            Object.keys(agePerformance).forEach(age => {
                if (agePerformance[age].length > 0) {
                    const avgGrowth = agePerformance[age].reduce((a, b) => a + b, 0) / agePerformance[age].length;
                    if (avgGrowth > bestAgeGrowth) {
                        bestAgeGrowth = avgGrowth;
                        bestAge = age;
                    }
                }
            });
            
            // Find best promotion type
            let bestPromotion = '';
            let bestPromotionOps = -Infinity;
            Object.keys(promotionPerformance).forEach(promo => {
                if (promotionPerformance[promo].length > 0) {
                    const avgOps = promotionPerformance[promo].reduce((a, b) => a + b, 0) / promotionPerformance[promo].length;
                    if (avgOps > bestPromotionOps) {
                        bestPromotionOps = avgOps;
                        bestPromotion = promo;
                    }
                }
            });
            
            // Update insights cards - ensure we're analyzing GLs (not PGs)
            const insightCards = document.querySelectorAll('#hve-analysis .section:last-child > div:last-child > div');
            
            if (insightCards.length >= 3) {
                insightCards[0].innerHTML = `
                    <h4 style="color: #27ae60; margin-bottom: 10px;">üéÜ Highest New Product Acceptance GL</h4>
                    <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">${bestGL}</p>
                    <p style="color: #7f8c8d; font-size: 0.9em;">0-3M ASIN YOY Growth: +${bestGrowth.toFixed(1)}%</p>
                `;
                
                insightCards[1].innerHTML = `
                    <h4 style="color: #f39c12; margin-bottom: 10px;">‚ö†Ô∏è Weak New Product Growth GL</h4>
                    <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">${worstGL}</p>
                    <p style="color: #7f8c8d; font-size: 0.9em;">0-3M ASIN YOY Growth: ${worstGrowth.toFixed(1)}%</p>
                `;
                
                insightCards[2].innerHTML = `
                    <h4 style="color: #8e44ad; margin-bottom: 10px;">üìà Stable Growth GL</h4>
                    <p style="font-size: 1.2em; font-weight: bold; color: #2c3e50;">${bestAge} segment performs best</p>
                    <p style="color: #7f8c8d; font-size: 0.9em;">Stable growth across all age segments with ${bestPromotion} promotions</p>
                `;
            }
        }
        
        function updateGLAsinAgeChart() {
            if (!hveProcessed || hveData.length === 0) return;
            
            const ctx = document.getElementById('glAsinAgeChart');
            if (!ctx) return;
            
            // Get top 20 GLs by volume
            const glStats = {};
            hveData.forEach(item => {
                if (!glStats[item.gl]) {
                    glStats[item.gl] = { '0-3M': [], '3-12M': [], '12M+': [] };
                }
                glStats[item.gl][item.asinAge].push(item.yoyGrowth);
            });
            
            const topGLs = Object.keys(glStats)
                .map(gl => ({
                    gl: gl,
                    totalVolume: Object.values(glStats[gl]).flat().length
                }))
                .sort((a, b) => b.totalVolume - a.totalVolume)
                .slice(0, 20)
                .map(item => item.gl);
            
            const asinAge0_3M = topGLs.map(gl => {
                const values = glStats[gl]['0-3M'];
                return values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;
            });
            
            const asinAge3_12M = topGLs.map(gl => {
                const values = glStats[gl]['3-12M'];
                return values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;
            });
            
            const asinAge12M = topGLs.map(gl => {
                const values = glStats[gl]['12M+'];
                return values.length > 0 ? values.reduce((a, b) => a + b, 0) / values.length : 0;
            });
            
            if (ctx.chart) {
                ctx.chart.destroy();
            }
            
            ctx.chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: topGLs,
                    datasets: [{
                        label: '0-3M (New Products)',
                        data: asinAge0_3M,
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 4
                    }, {
                        label: '3-12M (Growing)',
                        data: asinAge3_12M,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 4
                    }, {
                        label: '12M+ (Mature)',
                        data: asinAge12M,
                        borderColor: '#f39c12',
                        backgroundColor: 'rgba(243, 156, 18, 0.1)',
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'YOY Growth %'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(0) + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'GL (Global Line)'
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        title: {
                            display: true,
                            text: 'YOY Growth by GL and ASIN Age'
                        }
                    }
                }
            });
        }
        
        function sendBulkEmails() {
            const reportType = document.getElementById('reportTypeSelect').value;
            const emailStatus = document.getElementById('emailStatus');
            
            // Check data availability
            if (reportType === 'performance' && performanceData.length === 0) {
                emailStatus.innerHTML = '‚ùå Please analyze performance data first in MCID/Brand Level Performance tab';
                emailStatus.style.background = '#f8d7da';
                emailStatus.style.color = '#721c24';
                emailStatus.style.display = 'block';
                return;
            }
            
            if (reportType === 'sourcing' && processedData.targetAsins.length === 0) {
                emailStatus.innerHTML = '‚ùå Please process target ASIN data first in Target ASIN Sourcing Engine tab';
                emailStatus.style.background = '#f8d7da';
                emailStatus.style.color = '#721c24';
                emailStatus.style.display = 'block';
                return;
            }
            
            emailStatus.innerHTML = 'üìß Sending bulk emails...';
            emailStatus.style.background = '#d1ecf1';
            emailStatus.style.color = '#0c5460';
            emailStatus.style.display = 'block';
            
            setTimeout(() => {
                const reportTypeText = reportType === 'performance' ? 'Performance Reports' : 'Target ASIN Sourcing Reports';
                const dataSource = reportType === 'performance' ? performanceData.length : processedData.targetAsins.length;
                const uniqueRecipients = reportType === 'performance' ? 
                    new Set(performanceData.map(p => p.mcid)).size : 
                    processedData.mcids.size;
                
                emailStatus.innerHTML = `‚úÖ Bulk Emails Sent Successfully!<br>
                üìß Sent ${reportTypeText} to ${uniqueRecipients} recipients<br>
                üìä Based on ${dataSource} data records<br>
                üìÑ Excel attachments generated automatically`;
                emailStatus.style.background = '#d4edda';
                emailStatus.style.color = '#155724';
            }, 3000);
        }
        
        function generatePromotionSubmissions() {
            promotionSubmissions = [];
            
            // Generate submissions for 70% of target ASINs
            const submissionCount = Math.floor(processedData.targetAsins.length * 0.7);
            const shuffled = [...processedData.targetAsins].sort(() => 0.5 - Math.random());
            
            for (let i = 0; i < submissionCount; i++) {
                const targetAsin = shuffled[i];
                const woc = Math.floor(Math.random() * 15 + 1); // 1-15 weeks
                const inventory = Math.floor(Math.random() * 200 + 10);
                
                promotionSubmissions.push({
                    asin: targetAsin.asin,
                    mcid: targetAsin.mcid,
                    brand: targetAsin.brand,
                    marketplace: targetAsin.marketplace,
                    promotionType: targetAsin.recommendation,
                    submissionDate: new Date(Date.now() + Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    inventory: inventory,
                    woc: woc,
                    forecastOps: Math.floor(Math.random() * 50000 + 10000)
                });
            }
        }
        
        function updateDashboardMarketplaceFilter() {
            const select = document.getElementById('dashboardMarketplaceSelect');
            
            // Clear existing options except first
            while (select.children.length > 1) {
                select.removeChild(select.lastChild);
            }
            
            // Add marketplace options
            Array.from(processedData.marketplaces).sort().forEach(marketplace => {
                const option = document.createElement('option');
                option.value = marketplace;
                option.textContent = marketplace;
                select.appendChild(option);
            });
        }
        
        function filterDashboardByMarketplace() {
            dashboardFiltered.marketplace = document.getElementById('dashboardMarketplaceSelect').value;
            updateDashboardMetrics();
            updateInventoryTable();
        }
        
        function updateDashboardMetrics() {
            let filteredSubmissions = promotionSubmissions;
            
            if (dashboardFiltered.marketplace !== 'all') {
                filteredSubmissions = promotionSubmissions.filter(s => s.marketplace === dashboardFiltered.marketplace);
            }
            
            const totalTargetAsins = dashboardFiltered.marketplace === 'all' ? 
                processedData.targetAsins.length : 
                processedData.targetAsins.filter(a => a.marketplace === dashboardFiltered.marketplace).length;
            
            const submittedAsins = filteredSubmissions.length;
            const submissionRate = totalTargetAsins > 0 ? Math.round((submittedAsins / totalTargetAsins) * 100) : 0;
            const uniqueMcids = new Set(filteredSubmissions.map(s => s.mcid)).size;
            const totalOps = filteredSubmissions.reduce((sum, s) => sum + s.forecastOps, 0);
            
            document.getElementById('totalAsins').textContent = submittedAsins.toLocaleString();
            document.getElementById('submissionRate').textContent = submissionRate + '%';
            document.getElementById('activeMcids').textContent = uniqueMcids;
            document.getElementById('revenue').textContent = '$' + (totalOps / 1000000).toFixed(1) + 'M';
        }
        
        function updateInventoryTable() {
            const tbody = document.getElementById('inventoryTableBody');
            tbody.innerHTML = '';
            
            let filteredSubmissions = promotionSubmissions;
            if (dashboardFiltered.marketplace !== 'all') {
                filteredSubmissions = promotionSubmissions.filter(s => s.marketplace === dashboardFiltered.marketplace);
            }
            
            if (filteredSubmissions.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #7f8c8d; padding: 30px;">No promotion submissions found for selected marketplace</td></tr>';
                return;
            }
            
            filteredSubmissions.slice(0, 10).forEach(submission => {
                const row = tbody.insertRow();
                
                let alertLevel, alertColor, actionRequired;
                if (submission.woc < 3) {
                    alertLevel = 'CRITICAL';
                    alertColor = '#e74c3c';
                    actionRequired = 'Your inventory is insufficient for 3 weeks turnover, please restock urgently!';
                } else if (submission.woc <= 8) {
                    alertLevel = 'WARNING';
                    alertColor = '#f39c12';
                    actionRequired = 'Your inventory is expected to last 4-8 weeks, please restock appropriately';
                } else {
                    alertLevel = 'GOOD';
                    alertColor = '#27ae60';
                    actionRequired = 'Your inventory is sufficient for turnover, please maintain current levels!';
                }
                
                row.innerHTML = `
                    <td>${submission.asin}</td>
                    <td>${submission.brand}</td>
                    <td>${submission.mcid}</td>
                    <td>${submission.inventory} units (${submission.woc}W)</td>
                    <td>${submission.promotionType}</td>
                    <td><span style="background: ${alertColor}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 11px;">${alertLevel}</span></td>
                    <td>${actionRequired}</td>
                `;
            });
        }
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'performance') {
                setTimeout(initOpsChart, 100);
            } else if (tabName === 'hve-analysis') {
                setTimeout(initGLAsinAgeChart, 100);
            }
        }
        
        function initOpsChart() {
            const ctx = document.getElementById('opsChart');
            if (!ctx || ctx.chart) return;
            
            updateChartData();
        }
        
        function updateChartPeriod() {
            const period = document.getElementById('timePeriodSelect').value;
            const chartTitle = document.getElementById('chartTitle');
            const chartDesc = document.getElementById('chartDescription');
            
            chartTitle.textContent = `üìâ ${period.charAt(0).toUpperCase() + period.slice(1)} Promotion OPS Trend`;
            chartDesc.innerHTML = `üìà <strong>Blue Line:</strong> 2025 ${period.charAt(0).toUpperCase() + period.slice(1)} Promotion OPS | <strong>Gray Line:</strong> 2024 YOY Comparison`;
            
            updateChartData();
        }
        
        function updateChartData() {
            const ctx = document.getElementById('opsChart');
            if (!ctx) return;
            
            const period = document.getElementById('timePeriodSelect').value;
            let labels, ops2025, ops2024;
            
            if (period === 'weekly') {
                labels = Array.from({length: 12}, (_, i) => `Week ${i + 1}`);
                ops2025 = [450000, 520000, 480000, 610000, 580000, 670000, 720000, 690000, 750000, 820000, 780000, 850000];
            } else if (period === 'monthly') {
                labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                ops2025 = [1800000, 2100000, 1950000, 2400000, 2200000, 2600000, 2800000, 2650000, 2900000, 3100000, 2950000, 3200000];
            } else {
                labels = ['2020', '2021', '2022', '2023', '2024', '2025'];
                ops2025 = [18000000, 22000000, 26000000, 30000000, 28000000, 32000000];
            }
            
            ops2024 = ops2025.map(val => val * 0.75 + Math.random() * (val * 0.1));
            
            if (ctx.chart) {
                ctx.chart.destroy();
            }
            
            ctx.chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `2025 ${period.charAt(0).toUpperCase() + period.slice(1)} Promotion OPS`,
                        data: ops2025,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        borderWidth: 3
                    }, {
                        label: '2024 YOY Comparison',
                        data: ops2024,
                        borderColor: '#95a5a6',
                        backgroundColor: 'rgba(149, 165, 166, 0.1)',
                        tension: 0.4,
                        borderWidth: 2,
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 1000000) return '$' + (value / 1000000) + 'M';
                                    return '$' + (value / 1000) + 'K';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }
        
        function filterAsinTable() {
            const selectedMarketplace = document.getElementById('asinMarketplaceSelect').value;
            const rows = document.querySelectorAll('.data-table tbody tr');
            
            rows.forEach(row => {
                if (selectedMarketplace === 'all' || selectedMarketplace === 'Select Marketplace') {
                    row.style.display = '';
                } else {
                    row.style.display = row.dataset.marketplace === selectedMarketplace ? '' : 'none';
                }
            });
            
            updateRecommendationDistributionByMarketplace(selectedMarketplace);
        }
        
        function updateRecommendationDistributionByMarketplace(marketplace) {
            let filteredAsins = processedData.targetAsins;
            
            if (marketplace && marketplace !== 'all' && marketplace !== 'Select Marketplace') {
                filteredAsins = processedData.targetAsins.filter(asin => asin.marketplace === marketplace);
            }
            
            const total = filteredAsins.length;
            if (total === 0) return;
            
            const recommendations = { dotd: 0, bd: 0, ld: 0, ped: 0 };
            filteredAsins.forEach(asin => {
                recommendations[asin.recommendation.toLowerCase()]++;
            });
            
            const cards = document.querySelectorAll('#data-management .metric-card .metric-number');
            cards[0].textContent = Math.round((recommendations.dotd / total) * 100) + '%';
            cards[1].textContent = Math.round((recommendations.bd / total) * 100) + '%';
            cards[2].textContent = Math.round((recommendations.ld / total) * 100) + '%';
            cards[3].textContent = Math.round((recommendations.ped / total) * 100) + '%';
        }
        
        function updateEmailTemplate() {
            const reportType = document.getElementById('reportTypeSelect').value;
            const textarea = document.querySelector('#email-automation textarea');
            
            if (reportType === 'performance') {
                // Link with MCID/Brand Level Performance data
                const totalOps = performanceData.length > 0 ? 
                    '$' + (performanceData.reduce((sum, p) => sum + p.ops, 0) / 1000000).toFixed(1) + 'M' : '{total_ops}';
                
                const promotionOps = { dotd: 0, bd: 0, ld: 0, ped: 0 };
                performanceData.forEach(p => {
                    const type = p.promotionType.toLowerCase();
                    promotionOps[type] += p.ops;
                });
                
                const dotdOps = '$' + (promotionOps.dotd / 1000).toFixed(0) + 'K';
                const bdOps = '$' + (promotionOps.bd / 1000).toFixed(0) + 'K';
                const ldOps = '$' + (promotionOps.ld / 1000).toFixed(0) + 'K';
                const pedOps = '$' + (promotionOps.ped / 1000).toFixed(0) + 'K';
                
                textarea.value = `Dear Valued Partner,

We are pleased to share your promotion performance analysis report based on historical data.

Performance Summary:
‚Ä¢ Account (MCID): {mcid}
‚Ä¢ Brand: {brand}
‚Ä¢ Marketplace: {marketplace}
‚Ä¢ Analysis Period: Last 90 Days

Key Performance Metrics:
‚Ä¢ Total Promotion OPS: ${totalOps}
‚Ä¢ DOTD Performance: ${dotdOps}
‚Ä¢ BD Performance: ${bdOps}
‚Ä¢ LD Performance: ${ldOps}
‚Ä¢ PED Performance: ${pedOps}
‚Ä¢ Total ASINs Analyzed: ${performanceData.length}

Please find the detailed performance analysis in the attached report. This analysis will help you optimize future promotion strategies.

Next Steps:
1. Review performance trends
2. Identify top-performing ASINs
3. Plan future promotion calendar
4. Optimize promotion mix

If you have any questions about the performance data, please don't hesitate to reach out.

Best regards,
Your Account Manager

Attachment: {mcid}_{brand}_{marketplace}_Performance_Report.xlsx`;
            } else {
                // Link with Target ASIN Sourcing Engine data
                const totalAsins = processedData.targetAsins.length;
                const dotdCount = processedData.recommendations.dotd;
                const bdCount = processedData.recommendations.bd;
                const ldCount = processedData.recommendations.ld;
                const pedCount = processedData.recommendations.ped;
                
                textarea.value = `Dear Valued Partner,

We are pleased to provide you with personalized promotion recommendations for your products based on our advanced AI analysis.

Account Summary:
‚Ä¢ Account (MCID): {mcid}
‚Ä¢ Brand: {brand}
‚Ä¢ Marketplace: {marketplace}
‚Ä¢ Total ASINs Analyzed: ${totalAsins}

Promotion Recommendations:
‚Ä¢ Deal of the Day (DOTD): ${dotdCount} ASINs
‚Ä¢ Best Deal (BD): ${bdCount} ASINs
‚Ä¢ Lightning Deal (LD): ${ldCount} ASINs
‚Ä¢ PED Campaigns: ${pedCount} ASINs

Please find the detailed ASIN recommendations in the attached Excel file. Each ASIN has been carefully analyzed using our proprietary algorithm to ensure optimal promotion performance.

Next Steps:
1. Review the attached recommendations
2. Select ASINs for your preferred promotion types
3. Submit campaigns through Seller Central
4. Monitor performance using our analytics dashboard

If you have any questions or need assistance with campaign setup, please don't hesitate to reach out to our team.

Best regards,
Your Account Manager

Attachment: {mcid}_{brand}_{marketplace}_Recommendations.xlsx`;
            }
            
            updateEmailMappingData();
        }
        
        function updateEmailMappingData() {
            const reportType = document.getElementById('reportTypeSelect').value;
            const textarea = document.querySelector('#email-automation textarea[placeholder*="MCID"]');
            let mappings = [];
            
            if (reportType === 'performance' && performanceData.length > 0) {
                // Use performance data MCIDs
                const uniqueMcids = [...new Set(performanceData.map(p => p.mcid))];
                uniqueMcids.forEach((mcid, index) => {
                    mappings.push(`${mcid},seller${index + 1}@company.com`);
                });
            } else if (reportType === 'sourcing' && processedData.targetAsins.length > 0) {
                // Use target ASIN data MCIDs
                Array.from(processedData.mcids).forEach((mcid, index) => {
                    mappings.push(`${mcid},seller${index + 1}@company.com`);
                });
            } else {
                // Default mappings
                mappings = [
                    '398000000000,seller1@company.com',
                    '563000000000,seller2@company.com',
                    '579000000000,seller3@company.com'
                ];
            }
            
            textarea.value = mappings.join('\n');
        }
        
        function updateMetrics() {
            const metrics = [
                { id: 'totalAsins', base: 1247, variance: 50 },
                { id: 'activeMcids', base: 23, variance: 3 },
                { id: 'campaigns', base: 156, variance: 10 }
            ];
            
            metrics.forEach(metric => {
                const element = document.getElementById(metric.id);
                if (element && Math.random() > 0.7) {
                    const change = Math.floor(Math.random() * metric.variance * 2) - metric.variance;
                    const newValue = Math.max(0, metric.base + change);
                    element.textContent = newValue.toLocaleString();
                }
            });
        }
        
        function updateRevenue() {
            const revenueElement = document.getElementById('revenue');
            if (revenueElement && Math.random() > 0.8) {
                const revenues = ['$2.1M', '$2.3M', '$2.4M', '$2.6M', '$2.8M'];
                revenueElement.textContent = revenues[Math.floor(Math.random() * revenues.length)];
            }
        }
        

        
        function initGLAsinAgeChart() {
            const ctx = document.getElementById('glAsinAgeChart');
            if (!ctx || ctx.chart) return;
            
            if (hveProcessed && hveData.length > 0) {
                updateGLAsinAgeChart();
            } else {
                // Default data when no HVE data is processed
                const glLabels = ['Camera', 'Electronics', 'Home Entertainment', 'Mobile_Electronics', 'Musical Instruments', 'Office Products', 'PC', 'Wireless', 'Baby', 'Beauty', 'Gourmet', 'Grocery', 'Health & Personal Care', 'Luxury Beauty', 'Personal_Care_Appliances', 'Wine', 'Art', 'Automotive', 'Home', 'Kitchen'].slice(0, 15);
                const asinAge0_3M = [45, 73, 68, 25, 161, 89, 34, 67, 92, 78, 56, 43, 87, 65, 91];
                const asinAge3_12M = [32, 58, 57, 31, 119, 76, 45, 54, 83, 69, 47, 38, 72, 58, 84];
                const asinAge12M = [28, 55, 47, 73, 79, 62, 41, 49, 71, 63, 44, 35, 68, 52, 77];
                
                ctx.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: glLabels,
                        datasets: [{
                            label: '0-3M (New Products)',
                            data: asinAge0_3M,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 4
                        }, {
                            label: '3-12M (Growing)',
                            data: asinAge3_12M,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 4
                        }, {
                            label: '12M+ (Mature)',
                            data: asinAge12M,
                            borderColor: '#f39c12',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'YOY Growth %'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value.toFixed(0) + '%';
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'GL (Global Line)'
                                },
                                ticks: {
                                    maxRotation: 45,
                                    minRotation: 45
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top'
                            },
                            title: {
                                display: true,
                                text: 'YOY Growth by GL and ASIN Age'
                            }
                        }
                    }
                });
            }
        }
        
        setInterval(updateMetrics, 3000);
        setInterval(updateRevenue, 5000);
        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.metric-card').forEach(card => {
                card.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                });
            });
            

        });
    </script>
</body>
</html>